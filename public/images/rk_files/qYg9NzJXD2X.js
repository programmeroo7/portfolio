if (self.CavalryLogger) { CavalryLogger.start_js(["avqtQ"]); }

__d("FDSBadge.react",["cx","React","makeFDSStandardComponent"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.$1=function(){var a=this.props,b=a.value;a=a.maxNumberValue;return a!==void 0&&b>a?a+"+":b};d.render=function(){var a=this.props,c=a.id,d=a.label,e=a.type;a=a.value;a=a>0;if(!a)return null;a="_1dp9"+(e==="regular"?" _1dpa":"")+(e==="special"?" _1dpb":"");e=b("React").jsx("span",{"aria-live":"polite",className:"accessible_elem",id:c,children:d});c=b("React").jsx("span",{"aria-hidden":!0,children:this.$1()});return b("React").jsxs("span",{className:a,"data-testid":this.props["data-testid"],children:[c,e]})};return c}(b("React").PureComponent);a.defaultProps={type:"regular",maxNumberValue:50};e.exports=b("makeFDSStandardComponent")("FDSBadge",a)}),null);
__d("MessengerJewelUnreadCount.react",["fbt","CurrentUser","FDSBadge.react","MercuryThreadlistConstants","MessengerState.re","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a){return b("React").jsx(b("MessengerState.re").jsComponent,{fbid:a.viewer,children:function(c){var d=h(c,a.viewer,a.initialCount);c=i(c,a.viewer);d=d+c;c=b("CurrentUser").getID()===a.viewer?"p2p":"p2b";a.onCountLoaded(c,d);c=g._("({unread_count})",[g._param("unread_count",Math.min(d,b("MercuryThreadlistConstants").MAX_UNREAD_COUNT))]);return b("React").jsx(b("FDSBadge.react"),{label:c,value:d,maxNumberValue:b("MercuryThreadlistConstants").MAX_UNREAD_COUNT})}})}function h(a,c,d){if(b("CurrentUser").getID()===c){return(c=(c=b("MessengerState.re").unreadCounts(a).inbox)==null?void 0:c.size)!=null?c:b("MessengerState.re").initialUnreadCounts(a).inbox}return(a=(c=b("MessengerState.re").unreadCounts(a).inbox)==null?void 0:c.size)!=null?a:d}function i(a,c){if(b("CurrentUser").getID()===c){return(c=(c=b("MessengerState.re").unreadCounts(a).pending)==null?void 0:c.size)!=null?c:b("MessengerState.re").initialUnreadCounts(a).pending}return 0}e.exports=a}),null);
__d("MessengerJewelTabController",["csx","Arbiter","Bootloader","CSS","CurrentUser","DOM","DOMQuery","Event","MercuryConfig","MessengerJewelUnreadCount.react","Parent","React","ReactDOM","$"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(){__p&&__p();function a(a){__p&&__p();var c=this;this.$4=function(a,b){a=c.$2.get(a);if(!a)return;a.count=b};if(!b("MercuryConfig").PageThreadlistTabConfig)return;this.$1=b("MercuryConfig").PageThreadlistTabConfig.pageID.toString();this.$2=new Map();b("DOMQuery").scry(a.root,"._8t-w").forEach(function(a){var d=a.getAttribute("data-type"),e=a.getAttribute("data-tabid");c.$2.set(d,{button:a,count:0,tabID:e,type:d});if(!b("MercuryConfig").PageThreadlistTabConfig.unseenJewelEnabled&&d==="p2b")return;e=a.querySelector("._8t-x");a=d==="p2p"?b("CurrentUser").getID():c.$1;d=d==="p2b"?b("MercuryConfig").PageThreadlistTabConfig.initialUnreadCount:null;b("ReactDOM").render(b("React").jsx(b("MessengerJewelUnreadCount.react"),{initialCount:d,onCountLoaded:c.$4,viewer:a}),e)});this.$3=b("DOM").find(a.root,"._8t-z");b("Event").listen(a.root,"click",function(a){a=b("Parent").bySelector(a.getTarget(),"._8t-w");if(a){a=(a=a.getAttribute("data-type"))!=null?a:"";c.$5(a)}});b("Arbiter").subscribe("layer_shown",function(a,b){b&&b.type==="Jewel"&&b.name==="mercurymessages"&&c.$6()})}var c=a.prototype;c.$5=function(a){__p&&__p();var c=this;this.$7();var d=this.$2.get(a);if(!d)return;b("CSS").show(b("$")(d.tabID));b("Event").fire(window,"resize");b("CSS").addClass(d.button,"selected");this.$8(d.button);a==="p2b"&&b("Bootloader").loadModules(["WebFunnelLogger","MessengerJewelNotificationWebFunnelAction"],function(a,d){var e=c.$9(),f=e.userCount;e=e.pageCount;new a("MessengerJewelNotificationWebFunnelDefinition").setAction(d.PAGE_TAB_OPENED).setSessionKey(b("CurrentUser").getAccountID()).addActionPayload("unreadPageCount",e).addActionPayload("unreadUserCount",f).log()},"MessengerJewelTabController")};c.$7=function(){this.$2.forEach(function(a,c){b("CSS").hide(b("$")(a.tabID)),b("CSS").removeClass(a.button,"selected")})};c.$8=function(a){var b;b=(b=this.$3.getAttribute("data-selected-tab"))!=null?b:"";b=this.$2.get(b);if(!b)return;b=b.button.getBoundingClientRect();a=a.getBoundingClientRect();b.left<a.left?this.$3.style.left=(b.width+20+a.width/2).toString()+"px":this.$3.style.left=(a.width/2).toString()+"px"};c.$9=function(){var a=this.$2.get("p2p");a=a?a.count:0;var b=this.$2.get("p2b");b=b?b.count:0;return{userCount:a,pageCount:b}};c.$6=function(){if(b("MercuryConfig").PageThreadlistTabConfig.unseenJewelEnabled){var a=this.$9(),c=a.userCount;a=a.pageCount;c===0&&a>0&&this.$5("p2b")}};return a}();e.exports=a}),null);